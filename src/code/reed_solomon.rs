use std::fmt::Debug;

use crate::{code::Code, util::galois_field_2m::GaloisField2m};

#[derive(Debug, Clone, PartialEq, Eq)]
pub struct ReedSolomon<
    const SYMBOL_FIELD_PPOLY: u16,
    const CODE_LEN: usize,
    const MESSAGE_LEN: usize,
    const PARITY_LEN: usize,
> {
    genpoly: [<Self as Code>::SymbolType; PARITY_LEN],
    genpoly_mul_table: Vec<[<Self as Code>::SymbolType; PARITY_LEN]>,
}

impl<
    const SYMBOL_FIELD_PPOLY: u16,
    const CODE_LEN: usize,
    const MESSAGE_LEN: usize,
    const PARITY_LEN: usize,
> ReedSolomon<SYMBOL_FIELD_PPOLY, CODE_LEN, MESSAGE_LEN, PARITY_LEN>
{
    pub fn new(genpoly: [<Self as Code>::SymbolType; PARITY_LEN]) -> Self {
        let mut genpoly_mul_table =
            vec![[Default::default(); PARITY_LEN]; <Self as Code>::SymbolType::SIZE.into()];
        for i in 0..<Self as Code>::SymbolType::SIZE {
            genpoly_mul_table[i as usize] = Self::genpoly_mul(
                genpoly,
                <Self as Code>::SymbolType::try_from(i).expect("genpoly error"),
            );
        }
        Self {
            genpoly,
            genpoly_mul_table,
        }
    }

    fn genpoly_mul(
        genpoly: [<Self as Code>::SymbolType; PARITY_LEN],
        value: <Self as Code>::SymbolType,
    ) -> [<Self as Code>::SymbolType; PARITY_LEN] {
        genpoly.map(|x| x * value)
    }

    fn poly_deg(poly: &[<Self as Code>::SymbolType]) -> usize {
        for i in (0..poly.len()).rev() {
            if poly[i] != <Self as Code>::SymbolType::zero() {
                return i;
            }
        }
        return 0;
    }
}

impl<
    const SYMBOL_FIELD_PPOLY: u16,
    const CODE_LEN: usize,
    const MESSAGE_LEN: usize,
    const PARITY_LEN: usize,
> Code for ReedSolomon<SYMBOL_FIELD_PPOLY, CODE_LEN, MESSAGE_LEN, PARITY_LEN>
{
    const CODE_LEN: usize = CODE_LEN;
    const MESSAGE_LEN: usize = MESSAGE_LEN;
    type SymbolType = GaloisField2m<SYMBOL_FIELD_PPOLY>;
    type CodeType = [Self::SymbolType; CODE_LEN];
    type MessageType = [Self::SymbolType; MESSAGE_LEN];

    fn encode(&self, message: Self::MessageType) -> Self::CodeType {
        let mut shifted_message = {
            let mut res = [Self::SymbolType::zero(); CODE_LEN];
            res[..MESSAGE_LEN].copy_from_slice(&message);
            res.rotate_right(PARITY_LEN - 1);
            res
        };

        let shifted_message_mod = {
            let mut res = shifted_message;
            let mut res_deg = Self::poly_deg(&res);
            let genpoly_deg = Self::poly_deg(&self.genpoly);
            while res_deg >= genpoly_deg {
                let polydeg_tmp: [Self::SymbolType; PARITY_LEN] =
                    self.genpoly_mul_table[res[res_deg].value() as usize];
                let shifted_polydeg_tmp = {
                    let mut res = [Self::SymbolType::zero(); CODE_LEN];
                    res[..PARITY_LEN].copy_from_slice(&polydeg_tmp);
                    res.rotate_right(res_deg - genpoly_deg);
                    res
                };
                for i in 0..CODE_LEN {
                    res[i] += shifted_polydeg_tmp[i];
                }
                res_deg = Self::poly_deg(&res);
            }
            res
        };

        for i in 0..CODE_LEN {
            shifted_message[i] += shifted_message_mod[i];
        }

        for i in shifted_message {
            print!("{}, ", i);
        }
        println!("");

        shifted_message
    }
    fn decode(&self, code: Self::CodeType) -> Self::MessageType {
        [Default::default(); MESSAGE_LEN]
    }
}

#[cfg(test)]
mod tests {
    use crate::{
        code::{Code, reed_solomon::ReedSolomon},
        util::galois_field_2m::GaloisField2m,
    };

    #[test]
    fn encode() {
        const PPOLY: u16 = 0b100011101;
        const N: usize = 46;
        const K: usize = 16;
        const PARITY_LEN: usize = 31;
        type F = GaloisField2m<PPOLY>;

        let coeffs = [
            89, 69, 153, 116, 176, 117, 111, 75, 73, 233, 242, 233, 65, 210, 21, 139, 103, 173, 67,
            118, 105, 210, 174, 110, 74, 69, 228, 82, 255, 181, 1,
        ];
        let genpoly = coeffs.map(|x| x.try_into().unwrap());
        let rs = ReedSolomon::<PPOLY, N, K, PARITY_LEN>::new(genpoly);

        let m = [
            116, 178, 211, 82, 207, 116, 201, 52, 6, 156, 157, 231, 71, 87, 245, 5,
        ];
        let m_poly = m.map(|x| F::new(x).unwrap());
        let enc = rs.encode(m_poly);
        let hex_str = {
            let mut s = String::new();
            for i in 0..N {
                s += &format!("{:02x}", enc[i].value());
            }
            s
        };

        // from HQC-1 intermediate value
        let res = "eda27a14973188fe613ac94fbedf1106416fb391801bbee1e2e7677430bf74b2d352cf74c934069c9de74757f505";

        assert_eq!(&hex_str, res);
    }

    #[test]
    fn genpoly_mul_table() {
        const PPOLY: u16 = 0b100011101;
        const N: usize = 46;
        const K: usize = 16;
        const PARITY_LEN: usize = 31;

        let coeffs = [
            89, 69, 153, 116, 176, 117, 111, 75, 73, 233, 242, 233, 65, 210, 21, 139, 103, 173, 67,
            118, 105, 210, 174, 110, 74, 69, 228, 82, 255, 181, 1,
        ];
        let genpoly = coeffs.map(|x| x.try_into().unwrap());
        let rs = ReedSolomon::<PPOLY, N, K, PARITY_LEN>::new(genpoly);

        let res = [
            [
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0,
            ],
            [
                89, 69, 153, 116, 176, 117, 111, 75, 73, 233, 242, 233, 65, 210, 21, 139, 103, 173,
                67, 118, 105, 210, 174, 110, 74, 69, 228, 82, 255, 181, 1,
            ],
            [
                178, 138, 47, 232, 125, 234, 222, 150, 146, 207, 249, 207, 130, 185, 42, 11, 206,
                71, 134, 236, 210, 185, 65, 220, 148, 138, 213, 164, 227, 119, 2,
            ],
            [
                235, 207, 182, 156, 205, 159, 177, 221, 219, 38, 11, 38, 195, 107, 63, 128, 169,
                234, 197, 154, 187, 107, 239, 178, 222, 207, 49, 246, 28, 194, 3,
            ],
            [
                121, 9, 94, 205, 250, 201, 161, 49, 57, 131, 239, 131, 25, 111, 84, 22, 129, 142,
                17, 197, 185, 111, 130, 165, 53, 9, 183, 85, 219, 238, 4,
            ],
            [
                32, 76, 199, 185, 74, 188, 206, 122, 112, 106, 29, 106, 88, 189, 65, 157, 230, 35,
                82, 179, 208, 189, 44, 203, 127, 76, 83, 7, 36, 91, 5,
            ],
            [
                203, 131, 113, 37, 135, 35, 127, 167, 171, 76, 22, 76, 155, 214, 126, 29, 79, 201,
                151, 41, 107, 214, 195, 121, 161, 131, 98, 241, 56, 153, 6,
            ],
            [
                146, 198, 232, 81, 55, 86, 16, 236, 226, 165, 228, 165, 218, 4, 107, 150, 40, 100,
                212, 95, 2, 4, 109, 23, 235, 198, 134, 163, 199, 44, 7,
            ],
            [
                242, 18, 188, 135, 233, 143, 95, 98, 114, 27, 195, 27, 50, 222, 168, 44, 31, 1, 34,
                151, 111, 222, 25, 87, 106, 18, 115, 170, 171, 193, 8,
            ],
            [
                171, 87, 37, 243, 89, 250, 48, 41, 59, 242, 49, 242, 115, 12, 189, 167, 120, 172,
                97, 225, 6, 12, 183, 57, 32, 87, 151, 248, 84, 116, 9,
            ],
            [
                64, 152, 147, 111, 148, 101, 129, 244, 224, 212, 58, 212, 176, 103, 130, 39, 209,
                70, 164, 123, 189, 103, 88, 139, 254, 152, 166, 14, 72, 182, 10,
            ],
            [
                25, 221, 10, 27, 36, 16, 238, 191, 169, 61, 200, 61, 241, 181, 151, 172, 182, 235,
                231, 13, 212, 181, 246, 229, 180, 221, 66, 92, 183, 3, 11,
            ],
            [
                139, 27, 226, 74, 19, 70, 254, 83, 75, 152, 44, 152, 43, 177, 252, 58, 158, 143,
                51, 82, 214, 177, 155, 242, 95, 27, 196, 255, 112, 47, 12,
            ],
            [
                210, 94, 123, 62, 163, 51, 145, 24, 2, 113, 222, 113, 106, 99, 233, 177, 249, 34,
                112, 36, 191, 99, 53, 156, 21, 94, 32, 173, 143, 154, 13,
            ],
            [
                57, 145, 205, 162, 110, 172, 32, 197, 217, 87, 213, 87, 169, 8, 214, 49, 80, 200,
                181, 190, 4, 8, 218, 46, 203, 145, 17, 91, 147, 88, 14,
            ],
            [
                96, 212, 84, 214, 222, 217, 79, 142, 144, 190, 39, 190, 232, 218, 195, 186, 55,
                101, 246, 200, 109, 218, 116, 64, 129, 212, 245, 9, 108, 237, 15,
            ],
            [
                249, 36, 101, 19, 207, 3, 190, 196, 228, 54, 155, 54, 100, 161, 77, 88, 62, 2, 68,
                51, 222, 161, 50, 174, 212, 36, 230, 73, 75, 159, 16,
            ],
            [
                160, 97, 252, 103, 127, 118, 209, 143, 173, 223, 105, 223, 37, 115, 88, 211, 89,
                175, 7, 69, 183, 115, 156, 192, 158, 97, 2, 27, 180, 42, 17,
            ],
            [
                75, 174, 74, 251, 178, 233, 96, 82, 118, 249, 98, 249, 230, 24, 103, 83, 240, 69,
                194, 223, 12, 24, 115, 114, 64, 174, 51, 237, 168, 232, 18,
            ],
            [
                18, 235, 211, 143, 2, 156, 15, 25, 63, 16, 144, 16, 167, 202, 114, 216, 151, 232,
                129, 169, 101, 202, 221, 28, 10, 235, 215, 191, 87, 93, 19,
            ],
            [
                128, 45, 59, 222, 53, 202, 31, 245, 221, 181, 116, 181, 125, 206, 25, 78, 191, 140,
                85, 246, 103, 206, 176, 11, 225, 45, 81, 28, 144, 113, 20,
            ],
            [
                217, 104, 162, 170, 133, 191, 112, 190, 148, 92, 134, 92, 60, 28, 12, 197, 216, 33,
                22, 128, 14, 28, 30, 101, 171, 104, 181, 78, 111, 196, 21,
            ],
            [
                50, 167, 20, 54, 72, 32, 193, 99, 79, 122, 141, 122, 255, 119, 51, 69, 113, 203,
                211, 26, 181, 119, 241, 215, 117, 167, 132, 184, 115, 6, 22,
            ],
            [
                107, 226, 141, 66, 248, 85, 174, 40, 6, 147, 127, 147, 190, 165, 38, 206, 22, 102,
                144, 108, 220, 165, 95, 185, 63, 226, 96, 234, 140, 179, 23,
            ],
            [
                11, 54, 217, 148, 38, 140, 225, 166, 150, 45, 88, 45, 86, 127, 229, 116, 33, 3,
                102, 164, 177, 127, 43, 249, 190, 54, 149, 227, 224, 94, 24,
            ],
            [
                82, 115, 64, 224, 150, 249, 142, 237, 223, 196, 170, 196, 23, 173, 240, 255, 70,
                174, 37, 210, 216, 173, 133, 151, 244, 115, 113, 177, 31, 235, 25,
            ],
            [
                185, 188, 246, 124, 91, 102, 63, 48, 4, 226, 161, 226, 212, 198, 207, 127, 239, 68,
                224, 72, 99, 198, 106, 37, 42, 188, 64, 71, 3, 41, 26,
            ],
            [
                224, 249, 111, 8, 235, 19, 80, 123, 77, 11, 83, 11, 149, 20, 218, 244, 136, 233,
                163, 62, 10, 20, 196, 75, 96, 249, 164, 21, 252, 156, 27,
            ],
            [
                114, 63, 135, 89, 220, 69, 64, 151, 175, 174, 183, 174, 79, 16, 177, 98, 160, 141,
                119, 97, 8, 16, 169, 92, 139, 63, 34, 182, 59, 176, 28,
            ],
            [
                43, 122, 30, 45, 108, 48, 47, 220, 230, 71, 69, 71, 14, 194, 164, 233, 199, 32, 52,
                23, 97, 194, 7, 50, 193, 122, 198, 228, 196, 5, 29,
            ],
            [
                192, 181, 168, 177, 161, 175, 158, 1, 61, 97, 78, 97, 205, 169, 155, 105, 110, 202,
                241, 141, 218, 169, 232, 128, 31, 181, 247, 18, 216, 199, 30,
            ],
            [
                153, 240, 49, 197, 17, 218, 241, 74, 116, 136, 188, 136, 140, 123, 142, 226, 9,
                103, 178, 251, 179, 123, 70, 238, 85, 240, 19, 64, 39, 114, 31,
            ],
            [
                239, 72, 202, 38, 131, 6, 97, 149, 213, 108, 43, 108, 200, 95, 154, 176, 124, 4,
                136, 102, 161, 95, 100, 65, 181, 72, 209, 146, 150, 35, 32,
            ],
            [
                182, 13, 83, 82, 51, 115, 14, 222, 156, 133, 217, 133, 137, 141, 143, 59, 27, 169,
                203, 16, 200, 141, 202, 47, 255, 13, 53, 192, 105, 150, 33,
            ],
            [
                93, 194, 229, 206, 254, 236, 191, 3, 71, 163, 210, 163, 74, 230, 176, 187, 178, 67,
                14, 138, 115, 230, 37, 157, 33, 194, 4, 54, 117, 84, 34,
            ],
            [
                4, 135, 124, 186, 78, 153, 208, 72, 14, 74, 32, 74, 11, 52, 165, 48, 213, 238, 77,
                252, 26, 52, 139, 243, 107, 135, 224, 100, 138, 225, 35,
            ],
            [
                150, 65, 148, 235, 121, 207, 192, 164, 236, 239, 196, 239, 209, 48, 206, 166, 253,
                138, 153, 163, 24, 48, 230, 228, 128, 65, 102, 199, 77, 205, 36,
            ],
            [
                207, 4, 13, 159, 201, 186, 175, 239, 165, 6, 54, 6, 144, 226, 219, 45, 154, 39,
                218, 213, 113, 226, 72, 138, 202, 4, 130, 149, 178, 120, 37,
            ],
            [
                36, 203, 187, 3, 4, 37, 30, 50, 126, 32, 61, 32, 83, 137, 228, 173, 51, 205, 31,
                79, 202, 137, 167, 56, 20, 203, 179, 99, 174, 186, 38,
            ],
            [
                125, 142, 34, 119, 180, 80, 113, 121, 55, 201, 207, 201, 18, 91, 241, 38, 84, 96,
                92, 57, 163, 91, 9, 86, 94, 142, 87, 49, 81, 15, 39,
            ],
            [
                29, 90, 118, 161, 106, 137, 62, 247, 167, 119, 232, 119, 250, 129, 50, 156, 99, 5,
                170, 241, 206, 129, 125, 22, 223, 90, 162, 56, 61, 226, 40,
            ],
            [
                68, 31, 239, 213, 218, 252, 81, 188, 238, 158, 26, 158, 187, 83, 39, 23, 4, 168,
                233, 135, 167, 83, 211, 120, 149, 31, 70, 106, 194, 87, 41,
            ],
            [
                175, 208, 89, 73, 23, 99, 224, 97, 53, 184, 17, 184, 120, 56, 24, 151, 173, 66, 44,
                29, 28, 56, 60, 202, 75, 208, 119, 156, 222, 149, 42,
            ],
            [
                246, 149, 192, 61, 167, 22, 143, 42, 124, 81, 227, 81, 57, 234, 13, 28, 202, 239,
                111, 107, 117, 234, 146, 164, 1, 149, 147, 206, 33, 32, 43,
            ],
            [
                100, 83, 40, 108, 144, 64, 159, 198, 158, 244, 7, 244, 227, 238, 102, 138, 226,
                139, 187, 52, 119, 238, 255, 179, 234, 83, 21, 109, 230, 12, 44,
            ],
            [
                61, 22, 177, 24, 32, 53, 240, 141, 215, 29, 245, 29, 162, 60, 115, 1, 133, 38, 248,
                66, 30, 60, 81, 221, 160, 22, 241, 63, 25, 185, 45,
            ],
            [
                214, 217, 7, 132, 237, 170, 65, 80, 12, 59, 254, 59, 97, 87, 76, 129, 44, 204, 61,
                216, 165, 87, 190, 111, 126, 217, 192, 201, 5, 123, 46,
            ],
            [
                143, 156, 158, 240, 93, 223, 46, 27, 69, 210, 12, 210, 32, 133, 89, 10, 75, 97,
                126, 174, 204, 133, 16, 1, 52, 156, 36, 155, 250, 206, 47,
            ],
            [
                22, 108, 175, 53, 76, 5, 223, 81, 49, 90, 176, 90, 172, 254, 215, 232, 66, 6, 204,
                85, 127, 254, 86, 239, 97, 108, 55, 219, 221, 188, 48,
            ],
            [
                79, 41, 54, 65, 252, 112, 176, 26, 120, 179, 66, 179, 237, 44, 194, 99, 37, 171,
                143, 35, 22, 44, 248, 129, 43, 41, 211, 137, 34, 9, 49,
            ],
            [
                164, 230, 128, 221, 49, 239, 1, 199, 163, 149, 73, 149, 46, 71, 253, 227, 140, 65,
                74, 185, 173, 71, 23, 51, 245, 230, 226, 127, 62, 203, 50,
            ],
            [
                253, 163, 25, 169, 129, 154, 110, 140, 234, 124, 187, 124, 111, 149, 232, 104, 235,
                236, 9, 207, 196, 149, 185, 93, 191, 163, 6, 45, 193, 126, 51,
            ],
            [
                111, 101, 241, 248, 182, 204, 126, 96, 8, 217, 95, 217, 181, 145, 131, 254, 195,
                136, 221, 144, 198, 145, 212, 74, 84, 101, 128, 142, 6, 82, 52,
            ],
            [
                54, 32, 104, 140, 6, 185, 17, 43, 65, 48, 173, 48, 244, 67, 150, 117, 164, 37, 158,
                230, 175, 67, 122, 36, 30, 32, 100, 220, 249, 231, 53,
            ],
            [
                221, 239, 222, 16, 203, 38, 160, 246, 154, 22, 166, 22, 55, 40, 169, 245, 13, 207,
                91, 124, 20, 40, 149, 150, 192, 239, 85, 42, 229, 37, 54,
            ],
            [
                132, 170, 71, 100, 123, 83, 207, 189, 211, 255, 84, 255, 118, 250, 188, 126, 106,
                98, 24, 10, 125, 250, 59, 248, 138, 170, 177, 120, 26, 144, 55,
            ],
            [
                228, 126, 19, 178, 165, 138, 128, 51, 67, 65, 115, 65, 158, 32, 127, 196, 93, 7,
                238, 194, 16, 32, 79, 184, 11, 126, 68, 113, 118, 125, 56,
            ],
            [
                189, 59, 138, 198, 21, 255, 239, 120, 10, 168, 129, 168, 223, 242, 106, 79, 58,
                170, 173, 180, 121, 242, 225, 214, 65, 59, 160, 35, 137, 200, 57,
            ],
            [
                86, 244, 60, 90, 216, 96, 94, 165, 209, 142, 138, 142, 28, 153, 85, 207, 147, 64,
                104, 46, 194, 153, 14, 100, 159, 244, 145, 213, 149, 10, 58,
            ],
            [
                15, 177, 165, 46, 104, 21, 49, 238, 152, 103, 120, 103, 93, 75, 64, 68, 244, 237,
                43, 88, 171, 75, 160, 10, 213, 177, 117, 135, 106, 191, 59,
            ],
            [
                157, 119, 77, 127, 95, 67, 33, 2, 122, 194, 156, 194, 135, 79, 43, 210, 220, 137,
                255, 7, 169, 79, 205, 29, 62, 119, 243, 36, 173, 147, 60,
            ],
            [
                196, 50, 212, 11, 239, 54, 78, 73, 51, 43, 110, 43, 198, 157, 62, 89, 187, 36, 188,
                113, 192, 157, 99, 115, 116, 50, 23, 118, 82, 38, 61,
            ],
            [
                47, 253, 98, 151, 34, 169, 255, 148, 232, 13, 101, 13, 5, 246, 1, 217, 18, 206,
                121, 235, 123, 246, 140, 193, 170, 253, 38, 128, 78, 228, 62,
            ],
            [
                118, 184, 251, 227, 146, 220, 144, 223, 161, 228, 151, 228, 68, 36, 20, 82, 117,
                99, 58, 157, 18, 36, 34, 175, 224, 184, 194, 210, 177, 81, 63,
            ],
            [
                195, 144, 137, 76, 27, 12, 194, 55, 183, 216, 86, 216, 141, 190, 41, 125, 248, 8,
                13, 204, 95, 190, 200, 130, 119, 144, 191, 57, 49, 70, 64,
            ],
            [
                154, 213, 16, 56, 171, 121, 173, 124, 254, 49, 164, 49, 204, 108, 60, 246, 159,
                165, 78, 186, 54, 108, 102, 236, 61, 213, 91, 107, 206, 243, 65,
            ],
            [
                113, 26, 166, 164, 102, 230, 28, 161, 37, 23, 175, 23, 15, 7, 3, 118, 54, 79, 139,
                32, 141, 7, 137, 94, 227, 26, 106, 157, 210, 49, 66,
            ],
            [
                40, 95, 63, 208, 214, 147, 115, 234, 108, 254, 93, 254, 78, 213, 22, 253, 81, 226,
                200, 86, 228, 213, 39, 48, 169, 95, 142, 207, 45, 132, 67,
            ],
            [
                186, 153, 215, 129, 225, 197, 99, 6, 142, 91, 185, 91, 148, 209, 125, 107, 121,
                134, 28, 9, 230, 209, 74, 39, 66, 153, 8, 108, 234, 168, 68,
            ],
            [
                227, 220, 78, 245, 81, 176, 12, 77, 199, 178, 75, 178, 213, 3, 104, 224, 30, 43,
                95, 127, 143, 3, 228, 73, 8, 220, 236, 62, 21, 29, 69,
            ],
            [
                8, 19, 248, 105, 156, 47, 189, 144, 28, 148, 64, 148, 22, 104, 87, 96, 183, 193,
                154, 229, 52, 104, 11, 251, 214, 19, 221, 200, 9, 223, 70,
            ],
            [
                81, 86, 97, 29, 44, 90, 210, 219, 85, 125, 178, 125, 87, 186, 66, 235, 208, 108,
                217, 147, 93, 186, 165, 149, 156, 86, 57, 154, 246, 106, 71,
            ],
            [
                49, 130, 53, 203, 242, 131, 157, 85, 197, 195, 149, 195, 191, 96, 129, 81, 231, 9,
                47, 91, 48, 96, 209, 213, 29, 130, 204, 147, 154, 135, 72,
            ],
            [
                104, 199, 172, 191, 66, 246, 242, 30, 140, 42, 103, 42, 254, 178, 148, 218, 128,
                164, 108, 45, 89, 178, 127, 187, 87, 199, 40, 193, 101, 50, 73,
            ],
            [
                131, 8, 26, 35, 143, 105, 67, 195, 87, 12, 108, 12, 61, 217, 171, 90, 41, 78, 169,
                183, 226, 217, 144, 9, 137, 8, 25, 55, 121, 240, 74,
            ],
            [
                218, 77, 131, 87, 63, 28, 44, 136, 30, 229, 158, 229, 124, 11, 190, 209, 78, 227,
                234, 193, 139, 11, 62, 103, 195, 77, 253, 101, 134, 69, 75,
            ],
            [
                72, 139, 107, 6, 8, 74, 60, 100, 252, 64, 122, 64, 166, 15, 213, 71, 102, 135, 62,
                158, 137, 15, 83, 112, 40, 139, 123, 198, 65, 105, 76,
            ],
            [
                17, 206, 242, 114, 184, 63, 83, 47, 181, 169, 136, 169, 231, 221, 192, 204, 1, 42,
                125, 232, 224, 221, 253, 30, 98, 206, 159, 148, 190, 220, 77,
            ],
            [
                250, 1, 68, 238, 117, 160, 226, 242, 110, 143, 131, 143, 36, 182, 255, 76, 168,
                192, 184, 114, 91, 182, 18, 172, 188, 1, 174, 98, 162, 30, 78,
            ],
            [
                163, 68, 221, 154, 197, 213, 141, 185, 39, 102, 113, 102, 101, 100, 234, 199, 207,
                109, 251, 4, 50, 100, 188, 194, 246, 68, 74, 48, 93, 171, 79,
            ],
            [
                58, 180, 236, 95, 212, 15, 124, 243, 83, 238, 205, 238, 233, 31, 100, 37, 198, 10,
                73, 255, 129, 31, 250, 44, 163, 180, 89, 112, 122, 217, 80,
            ],
            [
                99, 241, 117, 43, 100, 122, 19, 184, 26, 7, 63, 7, 168, 205, 113, 174, 161, 167,
                10, 137, 232, 205, 84, 66, 233, 241, 189, 34, 133, 108, 81,
            ],
            [
                136, 62, 195, 183, 169, 229, 162, 101, 193, 33, 52, 33, 107, 166, 78, 46, 8, 77,
                207, 19, 83, 166, 187, 240, 55, 62, 140, 212, 153, 174, 82,
            ],
            [
                209, 123, 90, 195, 25, 144, 205, 46, 136, 200, 198, 200, 42, 116, 91, 165, 111,
                224, 140, 101, 58, 116, 21, 158, 125, 123, 104, 134, 102, 27, 83,
            ],
            [
                67, 189, 178, 146, 46, 198, 221, 194, 106, 109, 34, 109, 240, 112, 48, 51, 71, 132,
                88, 58, 56, 112, 120, 137, 150, 189, 238, 37, 161, 55, 84,
            ],
            [
                26, 248, 43, 230, 158, 179, 178, 137, 35, 132, 208, 132, 177, 162, 37, 184, 32, 41,
                27, 76, 81, 162, 214, 231, 220, 248, 10, 119, 94, 130, 85,
            ],
            [
                241, 55, 157, 122, 83, 44, 3, 84, 248, 162, 219, 162, 114, 201, 26, 56, 137, 195,
                222, 214, 234, 201, 57, 85, 2, 55, 59, 129, 66, 64, 86,
            ],
            [
                168, 114, 4, 14, 227, 89, 108, 31, 177, 75, 41, 75, 51, 27, 15, 179, 238, 110, 157,
                160, 131, 27, 151, 59, 72, 114, 223, 211, 189, 245, 87,
            ],
            [
                200, 166, 80, 216, 61, 128, 35, 145, 33, 245, 14, 245, 219, 193, 204, 9, 217, 11,
                107, 104, 238, 193, 227, 123, 201, 166, 42, 218, 209, 24, 88,
            ],
            [
                145, 227, 201, 172, 141, 245, 76, 218, 104, 28, 252, 28, 154, 19, 217, 130, 190,
                166, 40, 30, 135, 19, 77, 21, 131, 227, 206, 136, 46, 173, 89,
            ],
            [
                122, 44, 127, 48, 64, 106, 253, 7, 179, 58, 247, 58, 89, 120, 230, 2, 23, 76, 237,
                132, 60, 120, 162, 167, 93, 44, 255, 126, 50, 111, 90,
            ],
            [
                35, 105, 230, 68, 240, 31, 146, 76, 250, 211, 5, 211, 24, 170, 243, 137, 112, 225,
                174, 242, 85, 170, 12, 201, 23, 105, 27, 44, 205, 218, 91,
            ],
            [
                177, 175, 14, 21, 199, 73, 130, 160, 24, 118, 225, 118, 194, 174, 152, 31, 88, 133,
                122, 173, 87, 174, 97, 222, 252, 175, 157, 143, 10, 246, 92,
            ],
            [
                232, 234, 151, 97, 119, 60, 237, 235, 81, 159, 19, 159, 131, 124, 141, 148, 63, 40,
                57, 219, 62, 124, 207, 176, 182, 234, 121, 221, 245, 67, 93,
            ],
            [
                3, 37, 33, 253, 186, 163, 92, 54, 138, 185, 24, 185, 64, 23, 178, 20, 150, 194,
                252, 65, 133, 23, 32, 2, 104, 37, 72, 43, 233, 129, 94,
            ],
            [
                90, 96, 184, 137, 10, 214, 51, 125, 195, 80, 234, 80, 1, 197, 167, 159, 241, 111,
                191, 55, 236, 197, 142, 108, 34, 96, 172, 121, 22, 52, 95,
            ],
            [
                44, 216, 67, 106, 152, 10, 163, 162, 98, 180, 125, 180, 69, 225, 179, 205, 132, 12,
                133, 170, 254, 225, 172, 195, 194, 216, 110, 171, 167, 101, 96,
            ],
            [
                117, 157, 218, 30, 40, 127, 204, 233, 43, 93, 143, 93, 4, 51, 166, 70, 227, 161,
                198, 220, 151, 51, 2, 173, 136, 157, 138, 249, 88, 208, 97,
            ],
            [
                158, 82, 108, 130, 229, 224, 125, 52, 240, 123, 132, 123, 199, 88, 153, 198, 74,
                75, 3, 70, 44, 88, 237, 31, 86, 82, 187, 15, 68, 18, 98,
            ],
            [
                199, 23, 245, 246, 85, 149, 18, 127, 185, 146, 118, 146, 134, 138, 140, 77, 45,
                230, 64, 48, 69, 138, 67, 113, 28, 23, 95, 93, 187, 167, 99,
            ],
            [
                85, 209, 29, 167, 98, 195, 2, 147, 91, 55, 146, 55, 92, 142, 231, 219, 5, 130, 148,
                111, 71, 142, 46, 102, 247, 209, 217, 254, 124, 139, 100,
            ],
            [
                12, 148, 132, 211, 210, 182, 109, 216, 18, 222, 96, 222, 29, 92, 242, 80, 98, 47,
                215, 25, 46, 92, 128, 8, 189, 148, 61, 172, 131, 62, 101,
            ],
            [
                231, 91, 50, 79, 31, 41, 220, 5, 201, 248, 107, 248, 222, 55, 205, 208, 203, 197,
                18, 131, 149, 55, 111, 186, 99, 91, 12, 90, 159, 252, 102,
            ],
            [
                190, 30, 171, 59, 175, 92, 179, 78, 128, 17, 153, 17, 159, 229, 216, 91, 172, 104,
                81, 245, 252, 229, 193, 212, 41, 30, 232, 8, 96, 73, 103,
            ],
            [
                222, 202, 255, 237, 113, 133, 252, 192, 16, 175, 190, 175, 119, 63, 27, 225, 155,
                13, 167, 61, 145, 63, 181, 148, 168, 202, 29, 1, 12, 164, 104,
            ],
            [
                135, 143, 102, 153, 193, 240, 147, 139, 89, 70, 76, 70, 54, 237, 14, 106, 252, 160,
                228, 75, 248, 237, 27, 250, 226, 143, 249, 83, 243, 17, 105,
            ],
            [
                108, 64, 208, 5, 12, 111, 34, 86, 130, 96, 71, 96, 245, 134, 49, 234, 85, 74, 33,
                209, 67, 134, 244, 72, 60, 64, 200, 165, 239, 211, 106,
            ],
            [
                53, 5, 73, 113, 188, 26, 77, 29, 203, 137, 181, 137, 180, 84, 36, 97, 50, 231, 98,
                167, 42, 84, 90, 38, 118, 5, 44, 247, 16, 102, 107,
            ],
            [
                167, 195, 161, 32, 139, 76, 93, 241, 41, 44, 81, 44, 110, 80, 79, 247, 26, 131,
                182, 248, 40, 80, 55, 49, 157, 195, 170, 84, 215, 74, 108,
            ],
            [
                254, 134, 56, 84, 59, 57, 50, 186, 96, 197, 163, 197, 47, 130, 90, 124, 125, 46,
                245, 142, 65, 130, 153, 95, 215, 134, 78, 6, 40, 255, 109,
            ],
            [
                21, 73, 142, 200, 246, 166, 131, 103, 187, 227, 168, 227, 236, 233, 101, 252, 212,
                196, 48, 20, 250, 233, 118, 237, 9, 73, 127, 240, 52, 61, 110,
            ],
            [
                76, 12, 23, 188, 70, 211, 236, 44, 242, 10, 90, 10, 173, 59, 112, 119, 179, 105,
                115, 98, 147, 59, 216, 131, 67, 12, 155, 162, 203, 136, 111,
            ],
            [
                213, 252, 38, 121, 87, 9, 29, 102, 134, 130, 230, 130, 33, 64, 254, 149, 186, 14,
                193, 153, 32, 64, 158, 109, 22, 252, 136, 226, 236, 250, 112,
            ],
            [
                140, 185, 191, 13, 231, 124, 114, 45, 207, 107, 20, 107, 96, 146, 235, 30, 221,
                163, 130, 239, 73, 146, 48, 3, 92, 185, 108, 176, 19, 79, 113,
            ],
            [
                103, 118, 9, 145, 42, 227, 195, 240, 20, 77, 31, 77, 163, 249, 212, 158, 116, 73,
                71, 117, 242, 249, 223, 177, 130, 118, 93, 70, 15, 141, 114,
            ],
            [
                62, 51, 144, 229, 154, 150, 172, 187, 93, 164, 237, 164, 226, 43, 193, 21, 19, 228,
                4, 3, 155, 43, 113, 223, 200, 51, 185, 20, 240, 56, 115,
            ],
            [
                172, 245, 120, 180, 173, 192, 188, 87, 191, 1, 9, 1, 56, 47, 170, 131, 59, 128,
                208, 92, 153, 47, 28, 200, 35, 245, 63, 183, 55, 20, 116,
            ],
            [
                245, 176, 225, 192, 29, 181, 211, 28, 246, 232, 251, 232, 121, 253, 191, 8, 92, 45,
                147, 42, 240, 253, 178, 166, 105, 176, 219, 229, 200, 161, 117,
            ],
            [
                30, 127, 87, 92, 208, 42, 98, 193, 45, 206, 240, 206, 186, 150, 128, 136, 245, 199,
                86, 176, 75, 150, 93, 20, 183, 127, 234, 19, 212, 99, 118,
            ],
            [
                71, 58, 206, 40, 96, 95, 13, 138, 100, 39, 2, 39, 251, 68, 149, 3, 146, 106, 21,
                198, 34, 68, 243, 122, 253, 58, 14, 65, 43, 214, 119,
            ],
            [
                39, 238, 154, 254, 190, 134, 66, 4, 244, 153, 37, 153, 19, 158, 86, 185, 165, 15,
                227, 14, 79, 158, 135, 58, 124, 238, 251, 72, 71, 59, 120,
            ],
            [
                126, 171, 3, 138, 14, 243, 45, 79, 189, 112, 215, 112, 82, 76, 67, 50, 194, 162,
                160, 120, 38, 76, 41, 84, 54, 171, 31, 26, 184, 142, 121,
            ],
            [
                149, 100, 181, 22, 195, 108, 156, 146, 102, 86, 220, 86, 145, 39, 124, 178, 107,
                72, 101, 226, 157, 39, 198, 230, 232, 100, 46, 236, 164, 76, 122,
            ],
            [
                204, 33, 44, 98, 115, 25, 243, 217, 47, 191, 46, 191, 208, 245, 105, 57, 12, 229,
                38, 148, 244, 245, 104, 136, 162, 33, 202, 190, 91, 249, 123,
            ],
            [
                94, 231, 196, 51, 68, 79, 227, 53, 205, 26, 202, 26, 10, 241, 2, 175, 36, 129, 242,
                203, 246, 241, 5, 159, 73, 231, 76, 29, 156, 213, 124,
            ],
            [
                7, 162, 93, 71, 244, 58, 140, 126, 132, 243, 56, 243, 75, 35, 23, 36, 67, 44, 177,
                189, 159, 35, 171, 241, 3, 162, 168, 79, 99, 96, 125,
            ],
            [
                236, 109, 235, 219, 57, 165, 61, 163, 95, 213, 51, 213, 136, 72, 40, 164, 234, 198,
                116, 39, 36, 72, 68, 67, 221, 109, 153, 185, 127, 162, 126,
            ],
            [
                181, 40, 114, 175, 137, 208, 82, 232, 22, 60, 193, 60, 201, 154, 61, 47, 141, 107,
                55, 81, 77, 154, 234, 45, 151, 40, 125, 235, 128, 23, 127,
            ],
            [
                155, 61, 15, 152, 54, 24, 153, 110, 115, 173, 172, 173, 7, 97, 82, 250, 237, 16,
                26, 133, 190, 97, 141, 25, 238, 61, 99, 114, 98, 140, 128,
            ],
            [
                194, 120, 150, 236, 134, 109, 246, 37, 58, 68, 94, 68, 70, 179, 71, 113, 138, 189,
                89, 243, 215, 179, 35, 119, 164, 120, 135, 32, 157, 57, 129,
            ],
            [
                41, 183, 32, 112, 75, 242, 71, 248, 225, 98, 85, 98, 133, 216, 120, 241, 35, 87,
                156, 105, 108, 216, 204, 197, 122, 183, 182, 214, 129, 251, 130,
            ],
            [
                112, 242, 185, 4, 251, 135, 40, 179, 168, 139, 167, 139, 196, 10, 109, 122, 68,
                250, 223, 31, 5, 10, 98, 171, 48, 242, 82, 132, 126, 78, 131,
            ],
            [
                226, 52, 81, 85, 204, 209, 56, 95, 74, 46, 67, 46, 30, 14, 6, 236, 108, 158, 11,
                64, 7, 14, 15, 188, 219, 52, 212, 39, 185, 98, 132,
            ],
            [
                187, 113, 200, 33, 124, 164, 87, 20, 3, 199, 177, 199, 95, 220, 19, 103, 11, 51,
                72, 54, 110, 220, 161, 210, 145, 113, 48, 117, 70, 215, 133,
            ],
            [
                80, 190, 126, 189, 177, 59, 230, 201, 216, 225, 186, 225, 156, 183, 44, 231, 162,
                217, 141, 172, 213, 183, 78, 96, 79, 190, 1, 131, 90, 21, 134,
            ],
            [
                9, 251, 231, 201, 1, 78, 137, 130, 145, 8, 72, 8, 221, 101, 57, 108, 197, 116, 206,
                218, 188, 101, 224, 14, 5, 251, 229, 209, 165, 160, 135,
            ],
            [
                105, 47, 179, 31, 223, 151, 198, 12, 1, 182, 111, 182, 53, 191, 250, 214, 242, 17,
                56, 18, 209, 191, 148, 78, 132, 47, 16, 216, 201, 77, 136,
            ],
            [
                48, 106, 42, 107, 111, 226, 169, 71, 72, 95, 157, 95, 116, 109, 239, 93, 149, 188,
                123, 100, 184, 109, 58, 32, 206, 106, 244, 138, 54, 248, 137,
            ],
            [
                219, 165, 156, 247, 162, 125, 24, 154, 147, 121, 150, 121, 183, 6, 208, 221, 60,
                86, 190, 254, 3, 6, 213, 146, 16, 165, 197, 124, 42, 58, 138,
            ],
            [
                130, 224, 5, 131, 18, 8, 119, 209, 218, 144, 100, 144, 246, 212, 197, 86, 91, 251,
                253, 136, 106, 212, 123, 252, 90, 224, 33, 46, 213, 143, 139,
            ],
            [
                16, 38, 237, 210, 37, 94, 103, 61, 56, 53, 128, 53, 44, 208, 174, 192, 115, 159,
                41, 215, 104, 208, 22, 235, 177, 38, 167, 141, 18, 163, 140,
            ],
            [
                73, 99, 116, 166, 149, 43, 8, 118, 113, 220, 114, 220, 109, 2, 187, 75, 20, 50,
                106, 161, 1, 2, 184, 133, 251, 99, 67, 223, 237, 22, 141,
            ],
            [
                162, 172, 194, 58, 88, 180, 185, 171, 170, 250, 121, 250, 174, 105, 132, 203, 189,
                216, 175, 59, 186, 105, 87, 55, 37, 172, 114, 41, 241, 212, 142,
            ],
            [
                251, 233, 91, 78, 232, 193, 214, 224, 227, 19, 139, 19, 239, 187, 145, 64, 218,
                117, 236, 77, 211, 187, 249, 89, 111, 233, 150, 123, 14, 97, 143,
            ],
            [
                98, 25, 106, 139, 249, 27, 39, 170, 151, 155, 55, 155, 99, 192, 31, 162, 211, 18,
                94, 182, 96, 192, 191, 183, 58, 25, 133, 59, 41, 19, 144,
            ],
            [
                59, 92, 243, 255, 73, 110, 72, 225, 222, 114, 197, 114, 34, 18, 10, 41, 180, 191,
                29, 192, 9, 18, 17, 217, 112, 92, 97, 105, 214, 166, 145,
            ],
            [
                208, 147, 69, 99, 132, 241, 249, 60, 5, 84, 206, 84, 225, 121, 53, 169, 29, 85,
                216, 90, 178, 121, 254, 107, 174, 147, 80, 159, 202, 100, 146,
            ],
            [
                137, 214, 220, 23, 52, 132, 150, 119, 76, 189, 60, 189, 160, 171, 32, 34, 122, 248,
                155, 44, 219, 171, 80, 5, 228, 214, 180, 205, 53, 209, 147,
            ],
            [
                27, 16, 52, 70, 3, 210, 134, 155, 174, 24, 216, 24, 122, 175, 75, 180, 82, 156, 79,
                115, 217, 175, 61, 18, 15, 16, 50, 110, 242, 253, 148,
            ],
            [
                66, 85, 173, 50, 179, 167, 233, 208, 231, 241, 42, 241, 59, 125, 94, 63, 53, 49,
                12, 5, 176, 125, 147, 124, 69, 85, 214, 60, 13, 72, 149,
            ],
            [
                169, 154, 27, 174, 126, 56, 88, 13, 60, 215, 33, 215, 248, 22, 97, 191, 156, 219,
                201, 159, 11, 22, 124, 206, 155, 154, 231, 202, 17, 138, 150,
            ],
            [
                240, 223, 130, 218, 206, 77, 55, 70, 117, 62, 211, 62, 185, 196, 116, 52, 251, 118,
                138, 233, 98, 196, 210, 160, 209, 223, 3, 152, 238, 63, 151,
            ],
            [
                144, 11, 214, 12, 16, 148, 120, 200, 229, 128, 244, 128, 81, 30, 183, 142, 204, 19,
                124, 33, 15, 30, 166, 224, 80, 11, 246, 145, 130, 210, 152,
            ],
            [
                201, 78, 79, 120, 160, 225, 23, 131, 172, 105, 6, 105, 16, 204, 162, 5, 171, 190,
                63, 87, 102, 204, 8, 142, 26, 78, 18, 195, 125, 103, 153,
            ],
            [
                34, 129, 249, 228, 109, 126, 166, 94, 119, 79, 13, 79, 211, 167, 157, 133, 2, 84,
                250, 205, 221, 167, 231, 60, 196, 129, 35, 53, 97, 165, 154,
            ],
            [
                123, 196, 96, 144, 221, 11, 201, 21, 62, 166, 255, 166, 146, 117, 136, 14, 101,
                249, 185, 187, 180, 117, 73, 82, 142, 196, 199, 103, 158, 16, 155,
            ],
            [
                233, 2, 136, 193, 234, 93, 217, 249, 220, 3, 27, 3, 72, 113, 227, 152, 77, 157,
                109, 228, 182, 113, 36, 69, 101, 2, 65, 196, 89, 60, 156,
            ],
            [
                176, 71, 17, 181, 90, 40, 182, 178, 149, 234, 233, 234, 9, 163, 246, 19, 42, 48,
                46, 146, 223, 163, 138, 43, 47, 71, 165, 150, 166, 137, 157,
            ],
            [
                91, 136, 167, 41, 151, 183, 7, 111, 78, 204, 226, 204, 202, 200, 201, 147, 131,
                218, 235, 8, 100, 200, 101, 153, 241, 136, 148, 96, 186, 75, 158,
            ],
            [
                2, 205, 62, 93, 39, 194, 104, 36, 7, 37, 16, 37, 139, 26, 220, 24, 228, 119, 168,
                126, 13, 26, 203, 247, 187, 205, 112, 50, 69, 254, 159,
            ],
            [
                116, 117, 197, 190, 181, 30, 248, 251, 166, 193, 135, 193, 207, 62, 200, 74, 145,
                20, 146, 227, 31, 62, 233, 88, 91, 117, 178, 224, 244, 175, 160,
            ],
            [
                45, 48, 92, 202, 5, 107, 151, 176, 239, 40, 117, 40, 142, 236, 221, 193, 246, 185,
                209, 149, 118, 236, 71, 54, 17, 48, 86, 178, 11, 26, 161,
            ],
            [
                198, 255, 234, 86, 200, 244, 38, 109, 52, 14, 126, 14, 77, 135, 226, 65, 95, 83,
                20, 15, 205, 135, 168, 132, 207, 255, 103, 68, 23, 216, 162,
            ],
            [
                159, 186, 115, 34, 120, 129, 73, 38, 125, 231, 140, 231, 12, 85, 247, 202, 56, 254,
                87, 121, 164, 85, 6, 234, 133, 186, 131, 22, 232, 109, 163,
            ],
            [
                13, 124, 155, 115, 79, 215, 89, 202, 159, 66, 104, 66, 214, 81, 156, 92, 16, 154,
                131, 38, 166, 81, 107, 253, 110, 124, 5, 181, 47, 65, 164,
            ],
            [
                84, 57, 2, 7, 255, 162, 54, 129, 214, 171, 154, 171, 151, 131, 137, 215, 119, 55,
                192, 80, 207, 131, 197, 147, 36, 57, 225, 231, 208, 244, 165,
            ],
            [
                191, 246, 180, 155, 50, 61, 135, 92, 13, 141, 145, 141, 84, 232, 182, 87, 222, 221,
                5, 202, 116, 232, 42, 33, 250, 246, 208, 17, 204, 54, 166,
            ],
            [
                230, 179, 45, 239, 130, 72, 232, 23, 68, 100, 99, 100, 21, 58, 163, 220, 185, 112,
                70, 188, 29, 58, 132, 79, 176, 179, 52, 67, 51, 131, 167,
            ],
            [
                134, 103, 121, 57, 92, 145, 167, 153, 212, 218, 68, 218, 253, 224, 96, 102, 142,
                21, 176, 116, 112, 224, 240, 15, 49, 103, 193, 74, 95, 110, 168,
            ],
            [
                223, 34, 224, 77, 236, 228, 200, 210, 157, 51, 182, 51, 188, 50, 117, 237, 233,
                184, 243, 2, 25, 50, 94, 97, 123, 34, 37, 24, 160, 219, 169,
            ],
            [
                52, 237, 86, 209, 33, 123, 121, 15, 70, 21, 189, 21, 127, 89, 74, 109, 64, 82, 54,
                152, 162, 89, 177, 211, 165, 237, 20, 238, 188, 25, 170,
            ],
            [
                109, 168, 207, 165, 145, 14, 22, 68, 15, 252, 79, 252, 62, 139, 95, 230, 39, 255,
                117, 238, 203, 139, 31, 189, 239, 168, 240, 188, 67, 172, 171,
            ],
            [
                255, 110, 39, 244, 166, 88, 6, 168, 237, 89, 171, 89, 228, 143, 52, 112, 15, 155,
                161, 177, 201, 143, 114, 170, 4, 110, 118, 31, 132, 128, 172,
            ],
            [
                166, 43, 190, 128, 22, 45, 105, 227, 164, 176, 89, 176, 165, 93, 33, 251, 104, 54,
                226, 199, 160, 93, 220, 196, 78, 43, 146, 77, 123, 53, 173,
            ],
            [
                77, 228, 8, 28, 219, 178, 216, 62, 127, 150, 82, 150, 102, 54, 30, 123, 193, 220,
                39, 93, 27, 54, 51, 118, 144, 228, 163, 187, 103, 247, 174,
            ],
            [
                20, 161, 145, 104, 107, 199, 183, 117, 54, 127, 160, 127, 39, 228, 11, 240, 166,
                113, 100, 43, 114, 228, 157, 24, 218, 161, 71, 233, 152, 66, 175,
            ],
            [
                141, 81, 160, 173, 122, 29, 70, 63, 66, 247, 28, 247, 171, 159, 133, 18, 175, 22,
                214, 208, 193, 159, 219, 246, 143, 81, 84, 169, 191, 48, 176,
            ],
            [
                212, 20, 57, 217, 202, 104, 41, 116, 11, 30, 238, 30, 234, 77, 144, 153, 200, 187,
                149, 166, 168, 77, 117, 152, 197, 20, 176, 251, 64, 133, 177,
            ],
            [
                63, 219, 143, 69, 7, 247, 152, 169, 208, 56, 229, 56, 41, 38, 175, 25, 97, 81, 80,
                60, 19, 38, 154, 42, 27, 219, 129, 13, 92, 71, 178,
            ],
            [
                102, 158, 22, 49, 183, 130, 247, 226, 153, 209, 23, 209, 104, 244, 186, 146, 6,
                252, 19, 74, 122, 244, 52, 68, 81, 158, 101, 95, 163, 242, 179,
            ],
            [
                244, 88, 254, 96, 128, 212, 231, 14, 123, 116, 243, 116, 178, 240, 209, 4, 46, 152,
                199, 21, 120, 240, 89, 83, 186, 88, 227, 252, 100, 222, 180,
            ],
            [
                173, 29, 103, 20, 48, 161, 136, 69, 50, 157, 1, 157, 243, 34, 196, 143, 73, 53,
                132, 99, 17, 34, 247, 61, 240, 29, 7, 174, 155, 107, 181,
            ],
            [
                70, 210, 209, 136, 253, 62, 57, 152, 233, 187, 10, 187, 48, 73, 251, 15, 224, 223,
                65, 249, 170, 73, 24, 143, 46, 210, 54, 88, 135, 169, 182,
            ],
            [
                31, 151, 72, 252, 77, 75, 86, 211, 160, 82, 248, 82, 113, 155, 238, 132, 135, 114,
                2, 143, 195, 155, 182, 225, 100, 151, 210, 10, 120, 28, 183,
            ],
            [
                127, 67, 28, 42, 147, 146, 25, 93, 48, 236, 223, 236, 153, 65, 45, 62, 176, 23,
                244, 71, 174, 65, 194, 161, 229, 67, 39, 3, 20, 241, 184,
            ],
            [
                38, 6, 133, 94, 35, 231, 118, 22, 121, 5, 45, 5, 216, 147, 56, 181, 215, 186, 183,
                49, 199, 147, 108, 207, 175, 6, 195, 81, 235, 68, 185,
            ],
            [
                205, 201, 51, 194, 238, 120, 199, 203, 162, 35, 38, 35, 27, 248, 7, 53, 126, 80,
                114, 171, 124, 248, 131, 125, 113, 201, 242, 167, 247, 134, 186,
            ],
            [
                148, 140, 170, 182, 94, 13, 168, 128, 235, 202, 212, 202, 90, 42, 18, 190, 25, 253,
                49, 221, 21, 42, 45, 19, 59, 140, 22, 245, 8, 51, 187,
            ],
            [
                6, 74, 66, 231, 105, 91, 184, 108, 9, 111, 48, 111, 128, 46, 121, 40, 49, 153, 229,
                130, 23, 46, 64, 4, 208, 74, 144, 86, 207, 31, 188,
            ],
            [
                95, 15, 219, 147, 217, 46, 215, 39, 64, 134, 194, 134, 193, 252, 108, 163, 86, 52,
                166, 244, 126, 252, 238, 106, 154, 15, 116, 4, 48, 170, 189,
            ],
            [
                180, 192, 109, 15, 20, 177, 102, 250, 155, 160, 201, 160, 2, 151, 83, 35, 255, 222,
                99, 110, 197, 151, 1, 216, 68, 192, 69, 242, 44, 104, 190,
            ],
            [
                237, 133, 244, 123, 164, 196, 9, 177, 210, 73, 59, 73, 67, 69, 70, 168, 152, 115,
                32, 24, 172, 69, 175, 182, 14, 133, 161, 160, 211, 221, 191,
            ],
            [
                88, 173, 134, 212, 45, 20, 91, 89, 196, 117, 250, 117, 138, 223, 123, 135, 21, 24,
                23, 73, 225, 223, 69, 155, 153, 173, 220, 75, 83, 202, 192,
            ],
            [
                1, 232, 31, 160, 157, 97, 52, 18, 141, 156, 8, 156, 203, 13, 110, 12, 114, 181, 84,
                63, 136, 13, 235, 245, 211, 232, 56, 25, 172, 127, 193,
            ],
            [
                234, 39, 169, 60, 80, 254, 133, 207, 86, 186, 3, 186, 8, 102, 81, 140, 219, 95,
                145, 165, 51, 102, 4, 71, 13, 39, 9, 239, 176, 189, 194,
            ],
            [
                179, 98, 48, 72, 224, 139, 234, 132, 31, 83, 241, 83, 73, 180, 68, 7, 188, 242,
                210, 211, 90, 180, 170, 41, 71, 98, 237, 189, 79, 8, 195,
            ],
            [
                33, 164, 216, 25, 215, 221, 250, 104, 253, 246, 21, 246, 147, 176, 47, 145, 148,
                150, 6, 140, 88, 176, 199, 62, 172, 164, 107, 30, 136, 36, 196,
            ],
            [
                120, 225, 65, 109, 103, 168, 149, 35, 180, 31, 231, 31, 210, 98, 58, 26, 243, 59,
                69, 250, 49, 98, 105, 80, 230, 225, 143, 76, 119, 145, 197,
            ],
            [
                147, 46, 247, 241, 170, 55, 36, 254, 111, 57, 236, 57, 17, 9, 5, 154, 90, 209, 128,
                96, 138, 9, 134, 226, 56, 46, 190, 186, 107, 83, 198,
            ],
            [
                202, 107, 110, 133, 26, 66, 75, 181, 38, 208, 30, 208, 80, 219, 16, 17, 61, 124,
                195, 22, 227, 219, 40, 140, 114, 107, 90, 232, 148, 230, 199,
            ],
            [
                170, 191, 58, 83, 196, 155, 4, 59, 182, 110, 57, 110, 184, 1, 211, 171, 10, 25, 53,
                222, 142, 1, 92, 204, 243, 191, 175, 225, 248, 11, 200,
            ],
            [
                243, 250, 163, 39, 116, 238, 107, 112, 255, 135, 203, 135, 249, 211, 198, 32, 109,
                180, 118, 168, 231, 211, 242, 162, 185, 250, 75, 179, 7, 190, 201,
            ],
            [
                24, 53, 21, 187, 185, 113, 218, 173, 36, 161, 192, 161, 58, 184, 249, 160, 196, 94,
                179, 50, 92, 184, 29, 16, 103, 53, 122, 69, 27, 124, 202,
            ],
            [
                65, 112, 140, 207, 9, 4, 181, 230, 109, 72, 50, 72, 123, 106, 236, 43, 163, 243,
                240, 68, 53, 106, 179, 126, 45, 112, 158, 23, 228, 201, 203,
            ],
            [
                211, 182, 100, 158, 62, 82, 165, 10, 143, 237, 214, 237, 161, 110, 135, 189, 139,
                151, 36, 27, 55, 110, 222, 105, 198, 182, 24, 180, 35, 229, 204,
            ],
            [
                138, 243, 253, 234, 142, 39, 202, 65, 198, 4, 36, 4, 224, 188, 146, 54, 236, 58,
                103, 109, 94, 188, 112, 7, 140, 243, 252, 230, 220, 80, 205,
            ],
            [
                97, 60, 75, 118, 67, 184, 123, 156, 29, 34, 47, 34, 35, 215, 173, 182, 69, 208,
                162, 247, 229, 215, 159, 181, 82, 60, 205, 16, 192, 146, 206,
            ],
            [
                56, 121, 210, 2, 243, 205, 20, 215, 84, 203, 221, 203, 98, 5, 184, 61, 34, 125,
                225, 129, 140, 5, 49, 219, 24, 121, 41, 66, 63, 39, 207,
            ],
            [
                161, 137, 227, 199, 226, 23, 229, 157, 32, 67, 97, 67, 238, 126, 54, 223, 43, 26,
                83, 122, 63, 126, 119, 53, 77, 137, 58, 2, 24, 85, 208,
            ],
            [
                248, 204, 122, 179, 82, 98, 138, 214, 105, 170, 147, 170, 175, 172, 35, 84, 76,
                183, 16, 12, 86, 172, 217, 91, 7, 204, 222, 80, 231, 224, 209,
            ],
            [
                19, 3, 204, 47, 159, 253, 59, 11, 178, 140, 152, 140, 108, 199, 28, 212, 229, 93,
                213, 150, 237, 199, 54, 233, 217, 3, 239, 166, 251, 34, 210,
            ],
            [
                74, 70, 85, 91, 47, 136, 84, 64, 251, 101, 106, 101, 45, 21, 9, 95, 130, 240, 150,
                224, 132, 21, 152, 135, 147, 70, 11, 244, 4, 151, 211,
            ],
            [
                216, 128, 189, 10, 24, 222, 68, 172, 25, 192, 142, 192, 247, 17, 98, 201, 170, 148,
                66, 191, 134, 17, 245, 144, 120, 128, 141, 87, 195, 187, 212,
            ],
            [
                129, 197, 36, 126, 168, 171, 43, 231, 80, 41, 124, 41, 182, 195, 119, 66, 205, 57,
                1, 201, 239, 195, 91, 254, 50, 197, 105, 5, 60, 14, 213,
            ],
            [
                106, 10, 146, 226, 101, 52, 154, 58, 139, 15, 119, 15, 117, 168, 72, 194, 100, 211,
                196, 83, 84, 168, 180, 76, 236, 10, 88, 243, 32, 204, 214,
            ],
            [
                51, 79, 11, 150, 213, 65, 245, 113, 194, 230, 133, 230, 52, 122, 93, 73, 3, 126,
                135, 37, 61, 122, 26, 34, 166, 79, 188, 161, 223, 121, 215,
            ],
            [
                83, 155, 95, 64, 11, 152, 186, 255, 82, 88, 162, 88, 220, 160, 158, 243, 52, 27,
                113, 237, 80, 160, 110, 98, 39, 155, 73, 168, 179, 148, 216,
            ],
            [
                10, 222, 198, 52, 187, 237, 213, 180, 27, 177, 80, 177, 157, 114, 139, 120, 83,
                182, 50, 155, 57, 114, 192, 12, 109, 222, 173, 250, 76, 33, 217,
            ],
            [
                225, 17, 112, 168, 118, 114, 100, 105, 192, 151, 91, 151, 94, 25, 180, 248, 250,
                92, 247, 1, 130, 25, 47, 190, 179, 17, 156, 12, 80, 227, 218,
            ],
            [
                184, 84, 233, 220, 198, 7, 11, 34, 137, 126, 169, 126, 31, 203, 161, 115, 157, 241,
                180, 119, 235, 203, 129, 208, 249, 84, 120, 94, 175, 86, 219,
            ],
            [
                42, 146, 1, 141, 241, 81, 27, 206, 107, 219, 77, 219, 197, 207, 202, 229, 181, 149,
                96, 40, 233, 207, 236, 199, 18, 146, 254, 253, 104, 122, 220,
            ],
            [
                115, 215, 152, 249, 65, 36, 116, 133, 34, 50, 191, 50, 132, 29, 223, 110, 210, 56,
                35, 94, 128, 29, 66, 169, 88, 215, 26, 175, 151, 207, 221,
            ],
            [
                152, 24, 46, 101, 140, 187, 197, 88, 249, 20, 180, 20, 71, 118, 224, 238, 123, 210,
                230, 196, 59, 118, 173, 27, 134, 24, 43, 89, 139, 13, 222,
            ],
            [
                193, 93, 183, 17, 60, 206, 170, 19, 176, 253, 70, 253, 6, 164, 245, 101, 28, 127,
                165, 178, 82, 164, 3, 117, 204, 93, 207, 11, 116, 184, 223,
            ],
            [
                183, 229, 76, 242, 174, 18, 58, 204, 17, 25, 209, 25, 66, 128, 225, 55, 105, 28,
                159, 47, 64, 128, 33, 218, 44, 229, 13, 217, 197, 233, 224,
            ],
            [
                238, 160, 213, 134, 30, 103, 85, 135, 88, 240, 35, 240, 3, 82, 244, 188, 14, 177,
                220, 89, 41, 82, 143, 180, 102, 160, 233, 139, 58, 92, 225,
            ],
            [
                5, 111, 99, 26, 211, 248, 228, 90, 131, 214, 40, 214, 192, 57, 203, 60, 167, 91,
                25, 195, 146, 57, 96, 6, 184, 111, 216, 125, 38, 158, 226,
            ],
            [
                92, 42, 250, 110, 99, 141, 139, 17, 202, 63, 218, 63, 129, 235, 222, 183, 192, 246,
                90, 181, 251, 235, 206, 104, 242, 42, 60, 47, 217, 43, 227,
            ],
            [
                206, 236, 18, 63, 84, 219, 155, 253, 40, 154, 62, 154, 91, 239, 181, 33, 232, 146,
                142, 234, 249, 239, 163, 127, 25, 236, 186, 140, 30, 7, 228,
            ],
            [
                151, 169, 139, 75, 228, 174, 244, 182, 97, 115, 204, 115, 26, 61, 160, 170, 143,
                63, 205, 156, 144, 61, 13, 17, 83, 169, 94, 222, 225, 178, 229,
            ],
            [
                124, 102, 61, 215, 41, 49, 69, 107, 186, 85, 199, 85, 217, 86, 159, 42, 38, 213, 8,
                6, 43, 86, 226, 163, 141, 102, 111, 40, 253, 112, 230,
            ],
            [
                37, 35, 164, 163, 153, 68, 42, 32, 243, 188, 53, 188, 152, 132, 138, 161, 65, 120,
                75, 112, 66, 132, 76, 205, 199, 35, 139, 122, 2, 197, 231,
            ],
            [
                69, 247, 240, 117, 71, 157, 101, 174, 99, 2, 18, 2, 112, 94, 73, 27, 118, 29, 189,
                184, 47, 94, 56, 141, 70, 247, 126, 115, 110, 40, 232,
            ],
            [
                28, 178, 105, 1, 247, 232, 10, 229, 42, 235, 224, 235, 49, 140, 92, 144, 17, 176,
                254, 206, 70, 140, 150, 227, 12, 178, 154, 33, 145, 157, 233,
            ],
            [
                247, 125, 223, 157, 58, 119, 187, 56, 241, 205, 235, 205, 242, 231, 99, 16, 184,
                90, 59, 84, 253, 231, 121, 81, 210, 125, 171, 215, 141, 95, 234,
            ],
            [
                174, 56, 70, 233, 138, 2, 212, 115, 184, 36, 25, 36, 179, 53, 118, 155, 223, 247,
                120, 34, 148, 53, 215, 63, 152, 56, 79, 133, 114, 234, 235,
            ],
            [
                60, 254, 174, 184, 189, 84, 196, 159, 90, 129, 253, 129, 105, 49, 29, 13, 247, 147,
                172, 125, 150, 49, 186, 40, 115, 254, 201, 38, 181, 198, 236,
            ],
            [
                101, 187, 55, 204, 13, 33, 171, 212, 19, 104, 15, 104, 40, 227, 8, 134, 144, 62,
                239, 11, 255, 227, 20, 70, 57, 187, 45, 116, 74, 115, 237,
            ],
            [
                142, 116, 129, 80, 192, 190, 26, 9, 200, 78, 4, 78, 235, 136, 55, 6, 57, 212, 42,
                145, 68, 136, 251, 244, 231, 116, 28, 130, 86, 177, 238,
            ],
            [
                215, 49, 24, 36, 112, 203, 117, 66, 129, 167, 246, 167, 170, 90, 34, 141, 94, 121,
                105, 231, 45, 90, 85, 154, 173, 49, 248, 208, 169, 4, 239,
            ],
            [
                78, 193, 41, 225, 97, 17, 132, 8, 245, 47, 74, 47, 38, 33, 172, 111, 87, 30, 219,
                28, 158, 33, 19, 116, 248, 193, 235, 144, 142, 118, 240,
            ],
            [
                23, 132, 176, 149, 209, 100, 235, 67, 188, 198, 184, 198, 103, 243, 185, 228, 48,
                179, 152, 106, 247, 243, 189, 26, 178, 132, 15, 194, 113, 195, 241,
            ],
            [
                252, 75, 6, 9, 28, 251, 90, 158, 103, 224, 179, 224, 164, 152, 134, 100, 153, 89,
                93, 240, 76, 152, 82, 168, 108, 75, 62, 52, 109, 1, 242,
            ],
            [
                165, 14, 159, 125, 172, 142, 53, 213, 46, 9, 65, 9, 229, 74, 147, 239, 254, 244,
                30, 134, 37, 74, 252, 198, 38, 14, 218, 102, 146, 180, 243,
            ],
            [
                55, 200, 119, 44, 155, 216, 37, 57, 204, 172, 165, 172, 63, 78, 248, 121, 214, 144,
                202, 217, 39, 78, 145, 209, 205, 200, 92, 197, 85, 152, 244,
            ],
            [
                110, 141, 238, 88, 43, 173, 74, 114, 133, 69, 87, 69, 126, 156, 237, 242, 177, 61,
                137, 175, 78, 156, 63, 191, 135, 141, 184, 151, 170, 45, 245,
            ],
            [
                133, 66, 88, 196, 230, 50, 251, 175, 94, 99, 92, 99, 189, 247, 210, 114, 24, 215,
                76, 53, 245, 247, 208, 13, 89, 66, 137, 97, 182, 239, 246,
            ],
            [
                220, 7, 193, 176, 86, 71, 148, 228, 23, 138, 174, 138, 252, 37, 199, 249, 127, 122,
                15, 67, 156, 37, 126, 99, 19, 7, 109, 51, 73, 90, 247,
            ],
            [
                188, 211, 149, 102, 136, 158, 219, 106, 135, 52, 137, 52, 20, 255, 4, 67, 72, 31,
                249, 139, 241, 255, 10, 35, 146, 211, 152, 58, 37, 183, 248,
            ],
            [
                229, 150, 12, 18, 56, 235, 180, 33, 206, 221, 123, 221, 85, 45, 17, 200, 47, 178,
                186, 253, 152, 45, 164, 77, 216, 150, 124, 104, 218, 2, 249,
            ],
            [
                14, 89, 186, 142, 245, 116, 5, 252, 21, 251, 112, 251, 150, 70, 46, 72, 134, 88,
                127, 103, 35, 70, 75, 255, 6, 89, 77, 158, 198, 192, 250,
            ],
            [
                87, 28, 35, 250, 69, 1, 106, 183, 92, 18, 130, 18, 215, 148, 59, 195, 225, 245, 60,
                17, 74, 148, 229, 145, 76, 28, 169, 204, 57, 117, 251,
            ],
            [
                197, 218, 203, 171, 114, 87, 122, 91, 190, 183, 102, 183, 13, 144, 80, 85, 201,
                145, 232, 78, 72, 144, 136, 134, 167, 218, 47, 111, 254, 89, 252,
            ],
            [
                156, 159, 82, 223, 194, 34, 21, 16, 247, 94, 148, 94, 76, 66, 69, 222, 174, 60,
                171, 56, 33, 66, 38, 232, 237, 159, 203, 61, 1, 236, 253,
            ],
            [
                119, 80, 228, 67, 15, 189, 164, 205, 44, 120, 159, 120, 143, 41, 122, 94, 7, 214,
                110, 162, 154, 41, 201, 90, 51, 80, 250, 203, 29, 46, 254,
            ],
            [
                46, 21, 125, 55, 191, 200, 203, 134, 101, 145, 109, 145, 206, 251, 111, 213, 96,
                123, 45, 212, 243, 251, 103, 52, 121, 21, 30, 153, 226, 155, 255,
            ],
        ];

        for (x, r) in rs.genpoly_mul_table.into_iter().zip(res) {
            for (xx, rr) in x.into_iter().zip(r.into_iter()) {
                assert_eq!(xx, GaloisField2m::<PPOLY>::new(rr).unwrap());
            }
        }
    }
}
